<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zoomable Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
</head>
<body class="bg-[#F0F7D2] ">
  <!-- Chart Section -->
  <div class="flex flex-col items-center mt-16 px-4 md:px-28">
    <div class="mb-4 w-full text-center">
      <h1 class="text-2xl font-bold text-[#537D5D]">Harvest Price Chart</h1>
    </div>
    <div class="mb-8 w-full text-center">
      <h2 class="text-lg text-gray-600">
        Monitor agricultural commodity price fluctuations for better harvest planning
      </h2>
    </div>
    <div class="w-full bg-white shadow-lg rounded-lg flex justify-center py-4 px-2">
      <div class="w-full md:w-[85%] h-[300px] md:h-[400px]">
        <canvas id="myChart" class="w-full h-full"></canvas>
      </div>
    </div>
  </div>

  <!-- Trending Seeds Section -->
  <div class="mt-16 px-4 md:px-28 mb-16">
    <h1 class="text-2xl font-bold mb-1">Trending Seeds</h1>
    <p class="mb-8 text-gray-600">
      Stay ahead with seeds that are gaining popularity this season:
    </p>

    <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">
      <!-- Seed Card Template -->
      <!-- Repeat for each seed -->
      <div class="bg-white rounded-xl shadow p-4  hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">Ciherang Rice</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>

      <!-- Duplicate and customize the card as needed -->
      <div class="bg-white rounded-xl shadow p-4 hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">IR64 Rice</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>

      <div class="bg-white rounded-xl shadow p-4  hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">Inpari 32 Rice</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>

      <!-- Hybrid Corn Cards -->
      <div class="bg-white rounded-xl shadow p-4 hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">Hybrid Corn P21</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>

      <div class="bg-white rounded-xl shadow p-4 hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">Hybrid Corn P21</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>

      <div class="bg-white rounded-xl shadow p-4 hover:shadow-lg transition">
        <div class="flex justify-center mb-2">
          <img src="../../tumbuhan_senyum.png" alt="Plant" class="h-16" />
        </div>
        <h2 class="text-lg font-semibold text-center">Hybrid Corn P21</h2>
        <p class="text-sm text-center text-gray-600">Suitable for: Java, Sulawesi</p>
        <p class="text-sm text-center text-gray-600">Harvest Time: 95–105 days</p>
        <p class="text-sm text-center text-gray-600 mb-2">Yield Potential: 10–12 tons/ha</p>
        <div class="flex justify-center text-yellow-400 text-xl">
          ★★★★★
        </div>
      </div>
    </div>
  </div>
  <div class="h-fit py-10 bg-[#537D5D] pl-10 pr-32 lg:flex lg:justify-between">
    <div class="mb-8 lg:w-[25%]">
        <div class="mb-4 text-2xl font-semibold underline text-white">Si Panen</div>
        <div class=" text-white">A modern agriculture platform to increase productivity and the welfare of Indonesian farmers.</div>
    </div>
    <div class="mb-8 ">
        <div class="mb-4 text-2xl font-semibold underline text-white">Si Panen</div>
        <div class=" text-white">
            <ul>Harvest Price Trends</ul>
            <ul>Best Seed Recomendations</ul>
            <ul>Plant Disease Detection</ul>
            <ul>Chatbot & Market</ul>
        </div>
    </div>
    <div class="mb-8">
        <div class="mb-4 text-2xl font-semibold underline text-white">Help</div>
        <div class=" text-white">
            <ul>FAQ</ul>
            <ul>User Guides</ul>
            <ul>Contact Us</ul>
            <ul>Privacy Policy</ul>
        </div>
    </div>
    <div class="mb-8">
        <div class="mb-4 text-2xl font-semibold underline text-white">Contact</div>
        <div class=" text-white">
            <ul>FAQ</ul>
            <ul>User Guides</ul>
            <ul>Contact Us</ul>
            <ul>Privacy Policy</ul>
        </div>
    </div>
</div>
</body>



<script>
  const data = {{ data | safe }}; 
  const conversionRate = 0.012;

  const tomatoData = data
    .filter(item => item["Crop"] === "Tomato")
    .map(item => ({
      x: item["Date"],
      y: item["Price (INR/quintal)"] * conversionRate
    }));

  const opiumData = data
    .filter(item => item["Crop"] === "Opium")
    .map(item => ({
      x: item["Date"],
      y: item["Price (INR/quintal)"] * conversionRate
    }));

    const sugarcaneData = data
    .filter(item => item["Crop"] === "Sugarcane")
    .map(item => ({
      x: item["Date"],
      y: item["Price (INR/quintal)"] * conversionRate
    }));

    const pomegranateData = data
    .filter(item => item["Crop"] === "Pomegranate")
    .map(item => ({
      x: item["Date"],
      y: item["Price (INR/quintal)"] * conversionRate
    }));



  const allDates = [...tomatoData, ...opiumData].map(d => new Date(d.x));
  const minDate = new Date(Math.min(...allDates));
  const maxDate = new Date(Math.max(...allDates));

  function getTimeUnit(range) {
    const duration = range.max - range.min;
    const oneDay = 24 * 60 * 60 * 1000;
    const oneMonth = oneDay * 30;
    const oneYear = oneMonth * 12;

    if (duration < oneMonth) return 'day';
    if (duration < oneYear) return 'month';
    return 'year';
  }

  const ctx = document.getElementById('myChart').getContext('2d');
  Chart.register(ChartZoom);

  const myChart = new Chart(ctx, {
    type: 'line',
    data: {
      datasets: [
        {
          label: data[0]["Crop"],
          data: tomatoData,
          borderColor: 'rgba(255, 99, 132, 1)',
          backgroundColor: 'rgba(255, 99, 132, 0.2)',
          fill: false,
          tension: 0.1,
          pointRadius: 2,
        },
        {
          label: data[1]["Crop"],
          data: opiumData,
          borderColor: 'rgba(54, 162, 235, 1)',
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          fill: false,
          tension: 0.1,
          pointRadius: 2,
        },
        {
          label: data[6]["Crop"],
          data: sugarcaneData,
          borderColor: 'rgba(255, 206, 86, 1)',
          backgroundColor: 'rgba(255, 206, 86, 0.2)',
          fill: false,
          tension: 0.1,
          pointRadius: 2,
        },
        {
          label: data[2]["Crop"],
          data: pomegranateData,
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
          fill: false,
          tension: 0.1,
          pointRadius: 2,
        },
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: {
        mode: 'nearest',
        axis: 'x',
        intersect: false
      },
      scales: {
        x: {
          type: 'time',
          time: {
            unit: 'month',
            tooltipFormat: 'dd MMM yyyy',
            displayFormats: {
              day: 'dd MMM',
              month: 'MMM yyyy',
              year: 'yyyy'
            }
          },
          title: {
            display: true,
            text: 'Date'
          },
          ticks: {
            maxTicksLimit: 12
          }
        },
        y: {
          beginAtZero: false,
          title: {
            display: true,
            text: 'Price (USD/quintal)'
          }
        }
      },
      plugins: {
        legend: {
          onClick: function (e, legendItem, legend) {
            const chart = legend.chart;
            const index = legendItem.datasetIndex;
            const meta = chart.getDatasetMeta(index);

            const visibleCount = chart.data.datasets.filter((_, i) => {
              const m = chart.getDatasetMeta(i);
              return !(m.hidden === true);
            }).length;

            if (!meta.hidden && visibleCount <= 1) {
              return;
            }

            meta.hidden = !meta.hidden;
            chart.update();
          },
          labels: {
            font: {
              size: 14,
              weight: 'lighter', // or 'normal', 'lighter', etc.
              style: 'italic', // optional
              family: 'Arial', // or any valid CSS font
           
            },
            color: '#333', // font color
            
          },
          
          position: 'bottom', // 'bottom', 'left', 'right'
          align: 'end', // 'start', 'center', 'end'
        },
        tooltip: {
          titleFont: {
            size: 14,
            weight: 'bold'
          },
          bodyFont: {
            size: 12
          },
          footerFont: {
            size: 10,
            style: 'italic'
          }
        },
        zoom: {
          pan: {
            enabled: true,
            mode: 'x',
            modifierKey: null, 
            threshold: 10 
          },
          zoom: {
            wheel: {
              enabled: true
            },
            pinch: {
              enabled: true
            },
            mode: 'x',
            onZoomComplete({ chart }) {
              const xScale = chart.scales.x;
              const newUnit = getTimeUnit(xScale);
              chart.options.scales.x.time.unit = newUnit;
              chart.update('none');
            }
          },
          limits: {
            x: {
              min: minDate.getTime(),
              max: maxDate.getTime(),
              minRange: 14 * 24 * 60 * 60 * 1000 
            }
          }
        }
      }
    }
  });
</script>
</html>